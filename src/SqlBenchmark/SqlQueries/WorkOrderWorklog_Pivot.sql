select top 2147483647 N4."HoursSpent",N5."Number",N5."Name",isnull(N6."ExternalNumber", N6."InternalNumber"),N8."Name",isnull(N11."Name", N'?'),N0."StartOn",N0."HoursSpent",N1."Number",N12."Number",Cast((N13."Number") as nvarchar(max)) + N' | ' + isnull(N13."Name", N'?'),isnull(N11."Name", N'?'),N0."HoursSpent",N0."Week",N0."YearOfWeek",N14."Name",case when not (N17."DateClosed" is null) then 1 else 0 end,N0."Cost",Cast((N13."Number") as nvarchar(max)) + N' | ' + isnull(N13."Name", N'?'),N0."DateCreated",N0."DateInsert",N0."DateUpdate",N0."EmployeeWorklogType",DATEADD(ms, (CONVERT(decimal(38, 19),(N0."HoursSpent")) * 3600000) % 86400000, DATEADD(day, (CONVERT(decimal(38, 19),(N0."HoursSpent")) * 3600000) / 86400000, N0."StartOn")),N18."Name",N0."Id",N0."IdOriginal",N0."IsAutoGenerated",case when (N0."HourlyRate" is null or (N18."LastRateModification" > N0."DateUpdate")) then 1 else 0 end,N0."IsRestBreakResolved",N0."IsSafetyBreakResolved",case when not (N0."WorklogTerminal" is null) then 1 else 0 end,case when ((isnull(N23."Name", N'?') + N':' + isnull(case when (N24."ManufacturingPurpose" = 4) then N'AUX' else case when (N24."ManufacturingPurpose" = 5) then N'TST' else isnull(N25."Position", isnull(N26."Name", isnull(N25."Description", N'?'))) end end, N'?')) is null or len(isnull(N23."Name", N'?') + N':' + isnull(case when (N24."ManufacturingPurpose" = 4) then N'AUX' else case when (N24."ManufacturingPurpose" = 5) then N'TST' else isnull(N25."Position", isnull(N26."Name", isnull(N25."Description", N'?'))) end end, N'?')) = 0) then N'?' else isnull(N23."Name", N'?') + N':' + isnull(case when (N24."ManufacturingPurpose" = 4) then N'AUX' else case when (N24."ManufacturingPurpose" = 5) then N'TST' else isnull(N25."Position", isnull(N26."Name", isnull(N25."Description", N'?'))) end end, N'?') end + N' (' + Cast((Round(N19."ProducedQuantity",0)) as nvarchar(max)) + N'pc, ' + Cast((DATEPART(Day, N19."DateRecorded")) as nvarchar(max)) + N'.' + Cast((DATEPART(Month, N19."DateRecorded")) as nvarchar(max)) + N'.' + Cast((DATEPART(Year, N19."DateRecorded")) as nvarchar(max)) + N')',N0."Note",isnull(N29."Name", case when (isnull(CharIndex(N'\', N27."UserName"), 0) > 0) then Substring(N27."UserName", (((Charindex(N'\', N27."UserName") - 1) + 1)) + 1, Len(N27."UserName") - ((Charindex(N'\', N27."UserName") - 1) + 1)) else N27."UserName" end),isnull(N32."Name", case when (isnull(CharIndex(N'\', N30."UserName"), 0) > 0) then Substring(N30."UserName", (((Charindex(N'\', N30."UserName") - 1) + 1)) + 1, Len(N30."UserName") - ((Charindex(N'\', N30."UserName") - 1) + 1)) else N30."UserName" end),isnull(N35."Name", case when (isnull(CharIndex(N'\', N33."UserName"), 0) > 0) then Substring(N33."UserName", (((Charindex(N'\', N33."UserName") - 1) + 1)) + 1, Len(N33."UserName") - ((Charindex(N'\', N33."UserName") - 1) + 1)) else N33."UserName" end),N36."PartCode",N0."ReportingCost",N37."Name",N38."Name",N0."ShiftDate",N0."StartOn",N0."Timestamp",Cast((N0."Week") as nvarchar(max)) + N'/' + Cast((N0."YearOfWeek") as nvarchar(max)),N39."Name",N40."Name",N0."WorklogType",N1."Number",N5."Number",isnull(N6."ExternalNumber", N6."InternalNumber"),N12."Number",N41."Name",N5."Name" from ((((((((((((((((((((((((((((((((((((((((("dbo"."Worklog" N0
 left join "dbo"."WorkOrderOperation" N1 on (N0."WorkOrderOperation" = N1."Id"))
 left join "dbo"."WorkOrderMilestone" N2 on (N1."WorkOrderMilestone" = N2."Id"))
 left join "dbo"."WorkOrder" N3 on (N2."WorkOrder" = N3."Id"))
 left join "dbo"."WorkOrderInfo" N4 on (N3."WorkOrderInfo" = N4."Id"))
 left join "dbo"."EngineeringOrder" N7 on (N3."Id" = N7."Id"))
 left join "dbo"."EngineeringOrderStatus" N8 on (N7."EngineeringOrderStatus" = N8."Id"))
 left join "dbo"."EngineeringInvoicedOrganizationUnit" N41 on (N7."EngineeringInvoicedOrganizationUnit" = N41."Id"))
 left join "dbo"."WorkOrder" N5 on (N1."WorkOrder" = N5."Id"))
 left join "dbo"."PurchaseOrder" N6 on (N5."PurchaseOrder" = N6."Id"))
 left join "dbo"."Project" N12 on (N6."Project" = N12."Id"))
 left join "dbo"."Employee" N9 on (N0."Employee" = N9."Id"))
 left join "dbo"."EdfPerson" N10 on (N9."Person" = N10."Id"))
 left join "dbo"."Party" N11 on (N10."Id" = N11."Id"))
 left join "dbo"."CostCenter" N13 on (N0."CostCenter" = N13."Id"))
 left join "dbo"."Activity" N14 on (N0."Activity" = N14."Id"))
 left join "dbo"."WorkOrderOperation" N15 on (N0."AvailableWorkOrderOperation" = N15."Id"))
 left join "dbo"."WorkOrder" N16 on (N15."WorkOrder" = N16."Id"))
 left join "dbo"."PurchaseOrder" N17 on (N16."PurchaseOrder" = N17."Id"))
 left join "dbo"."HourlyRate" N18 on (N0."HourlyRate" = N18."Id"))
 left join "dbo"."ManufacturingOperationRecord" N19 on (N0."ManufacturingOperationRecord" = N19."Id"))
 left join "dbo"."ManufacturingOperation" N20 on (N19."ManufacturingOperation" = N20."Id"))
 left join "dbo"."WorkOrderOperation" N21 on (N20."Id" = N21."Id"))
 left join "dbo"."Operation" N22 on (N21."Id" = N22."Id"))
 left join "dbo"."OperationType" N23 on (N22."OperationType" = N23."Id"))
 left join "dbo"."RoutingItem" N24 on (N20."ManufacturingOrderItem" = N24."Id"))
 left join "dbo"."DrawingPosition" N25 on (N24."DrawingPosition" = N25."Id"))
 left join "dbo"."Article" N26 on (N24."Article" = N26."Id"))
 left join "dbo"."SecuritySystemUser" N27 on (N0."ObjectAuthor" = N27."Id"))
 left join "dbo"."EdfPerson" N28 on (N27."Person" = N28."Id"))
 left join "dbo"."Party" N29 on (N28."Id" = N29."Id"))
 left join "dbo"."SecuritySystemUser" N30 on (N0."ObjectLastUpdateAuthor" = N30."Id"))
 left join "dbo"."EdfPerson" N31 on (N30."Person" = N31."Id"))
 left join "dbo"."Party" N32 on (N31."Id" = N32."Id"))
 left join "dbo"."SecuritySystemUser" N33 on (N0."ObjectOwner" = N33."Id"))
 left join "dbo"."EdfPerson" N34 on (N33."Person" = N34."Id"))
 left join "dbo"."Party" N35 on (N34."Id" = N35."Id"))
 left join "dbo"."PartGroup" N36 on (N0."PartGroup" = N36."Id"))
 left join "dbo"."ExchangeRate" N37 on (N0."ReportingExchangeRate" = N37."Id"))
 left join "dbo"."Shift" N38 on (N0."Shift" = N38."Id"))
 left join "dbo"."WorkAction" N39 on (N0."WorkAction" = N39."Id"))
 left join "dbo"."WorklogTerminal" N40 on (N0."WorklogTerminal" = N40."Id"))
where ((N0."ObjectType" = 215) and N0."GCRecord" is null)
